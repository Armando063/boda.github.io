<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Boda Armando & Brenda Fernanda</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light text-center p-5">

  <h1>Armando & Brenda Fernanda 💍</h1>
  <h2 id="saludo"></h2>

  <form id="rsvpForm" class="container" style="max-width:500px;">
    <input type="hidden" name="id" id="id_invitado">
    <input type="hidden" name="nombre" id="nombre_invitado">

    <div class="mb-3">
      <label class="form-label">¿Asistirás?</label>
      <select class="form-select" id="asistencia" required>
        <option value="Sí">Sí, asistiré</option>
        <option value="No">No podré asistir</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Número de lugares confirmados</label>
      <input type="number" class="form-control" id="lugares" min="0">
      <div class="form-text" id="nota-lugares"></div>
    </div>

    <button type="submit" class="btn btn-dark">Confirmar 🎉</button>
  </form>

  <script>
    // URL de tu Google Apps Script
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbx5lauHFxYu1dCdlhI5yc8_gVcsApcjzyZU_SUwdMdUlRtUQS7ktAFCzVTDoRoy7xdXAg/exec";

    // Lista de invitados
    const invitados = {
      "12345": { nombre: "Juan Pérez", lugares: 4 },
      "67890": { nombre: "María López", lugares: 2 },
      "54321": { nombre: "Carlos Hernández", lugares: 1 }
    };

    // Obtener ID de la URL
    const params = new URLSearchParams(window.location.search);
    const id = params.get("id");

    if (id && invitados[id]) {
      const invitado = invitados[id];
      document.getElementById("saludo").innerText = 
        `¡Hola ${invitado.nombre}, tienes ${invitado.lugares} lugares reservados! 🎉`;

      document.getElementById("id_invitado").value = id;
      document.getElementById("nombre_invitado").value = invitado.nombre;

      const lugaresInput = document.getElementById("lugares");
      lugaresInput.max = invitado.lugares;
      lugaresInput.value = invitado.lugares;

      document.getElementById("nota-lugares").innerText = 
        `Puedes confirmar hasta ${invitado.lugares} lugar(es).`;

    } else {
      document.getElementById("saludo").innerText = "Invitación no válida ❌";
      document.querySelector("form").style.display = "none";
    }

    // Enviar datos a Google Sheets
    document.getElementById("rsvpForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const data = {
        id: document.getElementById("id_invitado").value,
        nombre: document.getElementById("nombre_invitado").value,
        asistencia: document.getElementById("asistencia").value,
        lugares: document.getElementById("lugares").value
      };

      fetch(SCRIPT_URL, {
        method: "POST",
        mode: "no-cors",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      })
      .then(() => alert("✅ ¡Gracias por confirmar!"))
      .catch(err => alert("❌ Error al enviar, intenta de nuevo"));

    });
  </script>

</body>
</html>
